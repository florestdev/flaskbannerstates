# Flask-Banner

> –ë–∏–±–ª–∏–æ—Ç–µ–∫–∞ –¥–ª—è –∂–µ—Å—Ç–∫–æ–π –±–ª–æ–∫–∏—Ä–æ–≤–∫–∏ –Ω–µ–∂–µ–ª–∞—Ç–µ–ª—å–Ω—ã—Ö —Å—Ç—Ä–∞–Ω –≤–æ Flask-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è—Ö.
> –ë—ã—Å—Ç—Ä–æ, –ø—Ä–æ—Å—Ç–æ –∏ —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ.

---

## üîπ –û–ø–∏—Å–∞–Ω–∏–µ

`Flask-Banner` –ø–æ–∑–≤–æ–ª—è–µ—Ç –º–≥–Ω–æ–≤–µ–Ω–Ω–æ –±–ª–æ–∫–∏—Ä–æ–≤–∞—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –ø–æ –≥–µ–æ–≥—Ä–∞—Ñ–∏—á–µ—Å–∫–æ–º—É –ø–æ–ª–æ–∂–µ–Ω–∏—é (IP-–∞–¥—Ä–µ—Å—É).
–û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏:

* –ü–æ–¥–¥–µ—Ä–∂–∫–∞ **—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ–≥–æ** (`Banner`) –∏ **–∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ–≥–æ** (`AsyncBanner`) —Ä–µ–∂–∏–º–æ–≤.
* –ò–≥–Ω–æ—Ä–∏—Ä—É–µ—Ç **–ª–æ–∫–∞–ª—å–Ω—ã–µ IP** (127.0.0.1, 192.168.x.x, ::1 –∏ —Ç.–¥.).
* –ü–æ–¥–¥–µ—Ä–∂–∫–∞ **–±–µ–ª–æ–≥–æ —Å–ø–∏—Å–∫–∞ —ç–Ω–¥–ø–æ–∏–Ω—Ç–æ–≤** ‚Äî –∑–∞–ø—Ä–æ—Å—ã –∫ —ç—Ç–∏–º —Ñ—É–Ω–∫—Ü–∏—è–º –≤—Å–µ–≥–¥–∞ –ø—Ä–æ–ø—É—Å–∫–∞—é—Ç—Å—è.
* –ö–µ—à–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–æ—Å–ª–µ–¥–Ω–∏—Ö 200 IP –¥–ª—è —É—Å–∫–æ—Ä–µ–Ω–∏—è —Ä–∞–±–æ—Ç—ã.
* –ú–≥–Ω–æ–≤–µ–Ω–Ω—ã–π –æ—Ç–∫–ª–∏–∫ ‚Äî –±–ª–æ–∫–∏—Ä–æ–≤–∫–∞ —Å –ø–µ—Ä–≤–æ–≥–æ –∑–∞–ø—Ä–æ—Å–∞.
* –ú–æ–∂–Ω–æ –æ—Ç–¥–∞–≤–∞—Ç—å –∫–∞–∫ **JSON**, —Ç–∞–∫ –∏ **HTML** –æ—Ç–≤–µ—Ç—ã.

---

## üîπ –£—Å—Ç–∞–Ω–æ–≤–∫–∞

```bash
pip install flask
# –î–ª—è –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ–≥–æ —Ä–µ–∂–∏–º–∞:
pip install "flask[async]" aiohttp
```

---

## üîπ –°–∏–Ω—Ö—Ä–æ–Ω–Ω—ã–π Banner

```python
from flask import Flask
from flaskbanstates import Banner  # –ò–º–ø–æ—Ä—Ç –≤–∞—à–µ–≥–æ –∫–ª–∞—Å—Å–∞ Banner

app = Flask(__name__)

# –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è Banner
Banner(
    app,
    banned_countries=['UA', 'RU'],      # –°–ø–∏—Å–æ–∫ –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö —Å—Ç—Ä–∞–Ω
    return_response={"ok": False, "error": "Forbidden 403."},  # –û—Ç–≤–µ—Ç –ø—Ä–∏ –±–∞–Ω–µ
    type_response='json',                # 'json' –∏–ª–∏ 'html'
    whitelisted_endpoint=['index']       # –≠–Ω–¥–ø–æ–∏–Ω—Ç—ã, –∫–æ—Ç–æ—Ä—ã–µ –≤—Å–µ–≥–¥–∞ –¥–æ—Å—Ç—É–ø–Ω—ã
)

@app.route('/')
def index():
    return 'Hi!'

@app.route('/about')
def about():
    return 'About page'

app.run('0.0.0.0', port=5000)
```

**–ü—Ä–∏–Ω—Ü–∏–ø —Ä–∞–±–æ—Ç—ã:**

1. –ü—Ä–∏ –∫–∞–∂–¥–æ–º –∑–∞–ø—Ä–æ—Å–µ Flask –≤—ã–∑—ã–≤–∞–µ—Ç `before_request`.
2. –ü—Ä–æ–≤–µ—Ä—è–µ—Ç IP –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –∏ –∫–µ—à.
3. –ï—Å–ª–∏ IP –≤ –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω–Ω–æ–π —Å—Ç—Ä–∞–Ω–µ ‚Äî –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç 403.
4. –ë–µ–ª—ã–µ —ç–Ω–¥–ø–æ–∏–Ω—Ç—ã –∏ –ª–æ–∫–∞–ª—å–Ω—ã–µ IP –∏–≥–Ω–æ—Ä–∏—Ä—É—é—Ç—Å—è.

---

## üîπ –ê—Å–∏–Ω—Ö—Ä–æ–Ω–Ω—ã–π Banner

```python
from flask import Flask
from flaskbanstates import AsyncBanner

app = Flask(__name__)

# –î–ª—è —Ä–∞–±–æ—Ç—ã AsyncBanner –Ω—É–∂–Ω–æ Flask >=2.3 –∏ –∑–∞–ø—É—Å–∫ —á–µ—Ä–µ–∑ ASGI —Å–µ—Ä–≤–µ—Ä
AsyncBanner(
    app,
    banned_countries=['UA', 'RU'],
    return_response={"ok": False, "error": "Forbidden 403."},
    type_response='json',
    whitelisted_endpoint=['index']
)

@app.route('/')
async def index():
    return 'Hi async!'

# –î–ª—è –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ–≥–æ –∑–∞–ø—É—Å–∫–∞ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ ASGI —Å–µ—Ä–≤–µ—Ä:
# hypercorn your_app:app
```

**–û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏ AsyncBanner:**

* –ê—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ –¥–µ–ª–∞–µ—Ç –∑–∞–ø—Ä–æ—Å –∫ `ip-api` —á–µ—Ä–µ–∑ `aiohttp`.
* –¢—Ä–µ–±—É–µ—Ç Flask —Å async-–ø–æ–¥–¥–µ—Ä–∂–∫–æ–π (`pip install "flask[async]"`).
* –ü–æ–¥—Ö–æ–¥–∏—Ç –¥–ª—è –±–æ–ª—å—à–∏—Ö –Ω–∞–≥—Ä—É–∑–æ–∫ –∏ ASGI —Å–µ—Ä–≤–µ—Ä–æ–≤ (Hypercorn, Uvicorn).

---

## üîπ –õ–æ–≥–∏–∫–∞ —Ä–∞–±–æ—Ç—ã

* –õ–æ–∫–∞–ª—å–Ω—ã–µ IP (`127.0.0.1`, `192.168.*.*`, `10.*.*.*`, `::1`) **–Ω–µ –±–ª–æ–∫–∏—Ä—É—é—Ç—Å—è**.
* –ü–æ–≤—Ç–æ—Ä–Ω—ã–µ –∑–∞–ø—Ä–æ—Å—ã –æ–¥–Ω–æ–≥–æ –∏ —Ç–æ–≥–æ –∂–µ IP –Ω–µ –≤—ã–∑—ã–≤–∞—é—Ç –ø–æ–≤—Ç–æ—Ä–Ω—ã—Ö –ª–æ–≥–æ–≤ (—á–∏—Å—Ç—ã–π –∫–æ–Ω—Å–æ–ª—å–Ω—ã–π –≤—ã–≤–æ–¥).
* –ë–µ–ª—ã–π —Å–ø–∏—Å–æ–∫ —ç–Ω–¥–ø–æ–∏–Ω—Ç–æ–≤ –ø–æ–∑–≤–æ–ª—è–µ—Ç –∏—Å–∫–ª—é—á–∏—Ç—å –æ—Ç–¥–µ–ª—å–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏ –∏–∑ –ø—Ä–æ–≤–µ—Ä–∫–∏.
* –ö–µ—à –ø–æ—Å–ª–µ–¥–Ω–∏—Ö 200 IP —É—Å–∫–æ—Ä—è–µ—Ç —Ä–∞–±–æ—Ç—É –∏ —Å–Ω–∏–∂–∞–µ—Ç –Ω–∞–≥—Ä—É–∑–∫—É –Ω–∞ –≤–Ω–µ—à–Ω–∏–π API.
* –ü—Ä–∏ –ø—Ä–µ–≤—ã—à–µ–Ω–∏–∏ –ª–∏–º–∏—Ç–∞ –∫–µ—à –æ—á–∏—â–∞–µ—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏.

---

## üîπ –û—Ç–≤–µ—Ç –ø—Ä–∏ –±–∞–Ω–µ

* **JSON (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é):**

```json
{
  "ok": false,
  "error": "Forbidden 403."
}
```

* **HTML (–µ—Å–ª–∏ —É–∫–∞–∑–∞–Ω–æ `type_response='html'`):**
  –ú–æ–∂–Ω–æ –æ—Ç–¥–∞–≤–∞—Ç—å –∫–∞—Å—Ç–æ–º–Ω—É—é —Å—Ç—Ä–∞–Ω–∏—Ü—É –±–∞–Ω–æ–≤.

---

## üîπ –ü—Ä–∏–º–µ—Ä HTML —Å—Ç—Ä–∞–Ω–∏—Ü—ã –¥–ª—è –±–∞–Ω–æ–≤

```html
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Access Denied</title>
    <style>
        body {
            background: #f44336;
            color: white;
            text-align: center;
            font-family: sans-serif;
            padding: 50px;
        }
        h1 {
            font-size: 4em;
        }
        p {
            font-size: 1.5em;
        }
        a {
            color: #fff;
            text-decoration: underline;
        }
    </style>
</head>
<body>
    <h1>üö´ Access Denied</h1>
    <p>Your country is blocked from accessing this site.</p>
    <p>If you think this is a mistake, <a href="mailto:support@example.com">contact support</a>.</p>
</body>
</html>
```

---

## üîπ –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç

1. –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å Flask.
2. –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å Banner –∏–ª–∏ AsyncBanner –≤ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏.
3. –î–æ–±–∞–≤–∏—Ç—å —Å–≤–æ–∏ —Å—Ç—Ä–∞–Ω—ã –≤ `banned_countries`.
4. –û–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ –¥–æ–±–∞–≤–∏—Ç—å –±–µ–ª—ã–µ —ç–Ω–¥–ø–æ–∏–Ω—Ç—ã.
5. –ì–æ—Ç–æ–≤–æ ‚Äî –∫–∞–∂–¥—ã–π –∑–∞–ø—Ä–æ—Å –±—É–¥–µ—Ç –ø—Ä–æ–≤–µ—Ä—è—Ç—å—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏.

```python
from flask import Flask
from flaskbanstates import Banner

app = Flask(__name__)
Banner(app, banned_countries=['UA', 'RU'], whitelisted_endpoint=['index'])

@app.route('/')
def index():
    return 'Hi!'

app.run()
```

---

## üîπ –õ–∏—Ü–µ–Ω–∑–∏—è

The unlicense ‚Äî –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ –Ω–∞ –∑–¥–æ—Ä–æ–≤—å–µ! üöÄ
